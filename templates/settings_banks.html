{% extends "base.html" %}

{% block title %}Bank Connections – LendifyMe{% endblock %}

{% block extra_css %}
.settings-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}
.settings-header h1 {
    margin: 0;
}
.btn-primary {
    background: #007bff;
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 4px;
    text-decoration: none;
    border: none;
    cursor: pointer;
    font-weight: 500;
}
.btn-primary:hover {
    background: #0056b3;
}
.connections-list {
    display: grid;
    gap: 1rem;
}
.connection-card {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.connection-info h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
}
.connection-meta {
    color: #666;
    font-size: 0.9rem;
}
.connection-actions {
    display: flex;
    gap: 0.5rem;
}
.btn-sm {
    padding: 0.5rem 1rem;
    border-radius: 4px;
    text-decoration: none;
    font-size: 0.9rem;
    border: none;
    cursor: pointer;
}
.btn-test {
    background: #28a745;
    color: white;
}
.btn-test:hover {
    background: #218838;
}
.btn-delete {
    background: #dc3545;
    color: white;
}
.btn-delete:hover {
    background: #c82333;
}
.empty-state {
    text-align: center;
    padding: 3rem;
    color: #666;
}
.empty-state svg {
    width: 64px;
    height: 64px;
    margin-bottom: 1rem;
    color: #ddd;
}
.back-link {
    display: inline-block;
    margin-bottom: 1rem;
    color: #007bff;
    text-decoration: none;
}
.back-link:hover {
    text-decoration: underline;
}
{% endblock %}

{% block content %}
<a href="/" class="back-link">← Back to Dashboard</a>

<div class="settings-header">
    <h1>Bank Connections</h1>
    <a href="/settings/banks/add" class="btn-primary">+ Add Bank Connection</a>
</div>

{% if connections %}
    <div class="connections-list">
        {% for conn in connections %}
        <div class="connection-card">
            <div class="connection-info">
                <h3>{{ conn.display_name or conn.connector_name }}</h3>
                <div class="connection-meta">
                    <strong>{{ conn.connector_name }}</strong>
                    {% if conn.last_synced_at %}
                        • Last synced: {{ conn.last_synced_at }}
                    {% else %}
                        • Never synced
                    {% endif %}
                </div>
            </div>
            <div class="connection-actions">
                <form method="post" action="/settings/banks/{{ conn.id }}/test" style="display: inline;">
                    <button type="submit" class="btn-sm btn-test">Test Connection</button>
                </form>
                <form method="post" action="/settings/banks/{{ conn.id }}/delete" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this connection?');">
                    <button type="submit" class="btn-sm btn-delete">Delete</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
        </svg>
        <h2>No Bank Connections</h2>
        <p>Connect your bank account to automatically import transactions.</p>
        <a href="/settings/banks/add" class="btn-primary" style="display: inline-block; margin-top: 1rem;">Add Your First Bank</a>
    </div>
{% endif %}
{% endblock %}
