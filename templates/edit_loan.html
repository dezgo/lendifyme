{% extends "base.html" %}

{% block title %}Edit Loan – LendifyMe{% endblock %}

{% block extra_css %}
input, textarea, button, select {
    width: 100%;
    margin-bottom: 1rem;
    padding: 0.75rem;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 4px;
}
select {
    background-color: white;
    cursor: pointer;
}
textarea {
    min-height: 100px;
}
button {
    background: #007bff;
    color: white;
    border: none;
    cursor: pointer;
    font-weight: bold;
}
button:hover {
    background: #0056b3;
}
label {
    display: block;
    margin-bottom: 0.25rem;
    font-weight: bold;
}
h1 {
    font-size: 1.75rem;
    margin-bottom: 1rem;
}
.back-link {
    display: inline-block;
    margin-bottom: 1rem;
    color: #007bff;
    text-decoration: none;
    font-weight: 600;
}
.back-link:hover {
    text-decoration: underline;
}
.info-text {
    background: #f8f9fa;
    padding: 0.75rem;
    border-radius: 4px;
    margin-bottom: 1rem;
    font-size: 0.9rem;
}
{% endblock %}

{% block content %}
<a href="/" class="back-link">← Back to Loans</a>

<h1>Edit Loan</h1>

<div class="info-text">
    <strong>Current repaid amount:</strong> ${{ '%.2f'|format((loan.amount_repaid or 0.0)) }}
    <br>
    Note: Changing the loan amount won't affect the repaid amount.
</div>

<form method="post">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <label>Borrower Name</label>
    <input type="text" name="borrower" value="{{ loan.borrower }}" placeholder="e.g. Alice Smith" required>

    <label>Bank Statement Name (optional)</label>
    <input type="text" name="bank_name" value="{{ loan.bank_name if loan.bank_name else '' }}"
           placeholder="e.g. Alice S or A Smith - as it appears in your bank">
    <p style="font-size: 0.85rem; color: #6c757d; margin-top: -0.5rem; margin-bottom: 1rem;">
        Use this if their name appears differently in your bank transactions
    </p>

    <label>Date Borrowed</label>
    <input type="date" name="date_borrowed" value="{{ loan.date_borrowed }}" required>

    <label>Amount ($)</label>
    <input type="number" step="0.01" name="amount" value="{{ loan.amount }}" required>

    <label>Repayment Schedule (optional)</label>
    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
        <input type="number" step="0.01" name="repayment_amount"
               placeholder="Amount"
               value="{{ loan.repayment_amount if loan.repayment_amount else '' }}"
               style="flex: 1;">
        <select name="repayment_frequency" style="flex: 1;">
            <option value="" {% if not loan.repayment_frequency %}selected{% endif %}>No schedule</option>
            <option value="weekly" {% if loan.repayment_frequency == 'weekly' %}selected{% endif %}>Weekly</option>
            <option value="fortnightly" {% if loan.repayment_frequency == 'fortnightly' %}selected{% endif %}>Fortnightly</option>
            <option value="monthly" {% if loan.repayment_frequency == 'monthly' %}selected{% endif %}>Monthly</option>
        </select>
    </div>

    <label>Note (optional)</label>
    <textarea name="note">{{ loan.note if loan.note else '' }}</textarea>

    <button type="submit">Save Changes</button>
</form>
{% endblock %}
